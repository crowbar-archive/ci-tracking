Add support for non-idempotent roles. 
