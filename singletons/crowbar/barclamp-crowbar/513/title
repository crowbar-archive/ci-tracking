Another chunk of fixes from the essex-hack-suse  branch
