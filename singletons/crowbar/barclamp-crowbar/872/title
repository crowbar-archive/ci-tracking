Refactored machines part including cli
