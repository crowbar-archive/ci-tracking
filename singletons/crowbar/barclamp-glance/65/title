swift support and smoketests fixes
